<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <!--<title>广东省科学技术情报研究所咨询策划中心任务管理系统</title>-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
    <!--<link href="css/bootstrap-theme.min.css" rel="stylesheet" media="screen">-->
    <link href="css/minimal.css" rel="stylesheet" media="screen">
    <!-- <link href="css/todc-bootstrap.css" rel="stylesheet" media="screen"> -->
    <link href="css/index.css" rel="stylesheet" media="screen">
    <link href="css/datetimepicker.css" rel="stylesheet" media="screen">
    <script type="text/javascript" src="js/jquery-1.7.1.js"></script>
    <script type="text/javascript" src="js/jquery.icheck.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/knockout-2.3.0.js"></script>
    <script type="text/javascript" src="js/bootstrap-datetimepicker.js"></script>
    <script type="text/javascript" src="js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script type="text/javascript" src="ckeditor/ckeditor.js"></script>
</head>
<body style="padding-top: 90px;">
<div class="container">
<header class="navbar-fixed-top  main-nav" role="banner">
    <nav class="navbar navbar-inverse nav-system-info" role="navigation">
        <div class="container">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#"><span class="glyphicon glyphicon-user"></span> User</a>
                </li>
                <li>
                    <a href="#"><span class="glyphicon glyphicon-off"></span> 退出</a>
                </li>
                <!--<li>
                    <div class="btn-group">
                        <div class="input-append">
                            <input class="col-md-2" id="appendedInputButtons" type="text">
                            <a class="btn" href="#"><i class="icon-search"></i></a>
                        </div>
                    </div>
                </li>-->
            </ul>
        </div>
    </nav>

    <nav class="navbar navbar-default nav-system-header" role="navigation">
        <div class="container">

            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a href="#taskList" data-toggle="tab">任务清单</a></li>
                <li><a href="#noteList" data-toggle="tab">工作日志</a></li>
                <!--<li>
                    <div class="btn-group">
                        <div class="input-append">
                            <input class="col-md-2" id="appendedInputButtons" type="text">
                            <a class="btn" href="#"><i class="icon-search"></i></a>
                        </div>
                    </div>
                </li>-->
            </ul>
            <div class="navbar-header">
                <span class="navbar-brand">广东省科学技术情报研究所咨询策划中心任务管理系统</span>
                <!--<span class="navbar-brand">Project Name</span>-->
            </div>
        </div>

    </nav>
</header>

<div class="row">
<div class="col-md-12">
<div id="mainTabContent" class="row tab-content">
<div class="tab-pane fade active in" id="taskList">
<div class="system-toolbar affix">
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="btn-group">
                    <button data-bind="click: showTaskEditView" class="btn btn-danger btn-new">发布任务</button>
                </div>
            </div>
            <div class="col-md-9">
                <div class="row">
                    <div class="col-md-6">
                        <ul class="list-inline">
                            <li>
                                <div class="btn-group">
                                    <a href="#" class="btn btn-default btn-action dropdown-toggle"
                                       data-toggle="dropdown">
                                        <div class="btn-checkbox"><input type="checkbox">
                                        </div>
                                        <span class="caret"></span></a>
                                    <ul class="dropdown-menu">
                                        <li><a href="#">全选</a></li>
                                        <li><a href="#">全不选</a></li>
                                    </ul>
                                </div>

                                <div class="btn-group item-action">
                                    <a class="btn btn-default btn-action" data-toggle="tooltip" data-placement="bottom"
                                       title="删除"><span
                                            class="glyphicon glyphicon-trash"></span></a>
                                </div>
                                <div class="btn-group item-action">
                                    <a class="btn btn-default dropdown-toggle btn-action" data-toggle="dropdown"><span
                                            class="glyphicon glyphicon-tags"></span><span
                                            class="caret caret-right"></span></a>
                                    <ul class="dropdown-menu">
                                        <li><a href="#">标记为完成</a></li>
                                        <li><a href="#">标记为取消</a></li>
                                    </ul>
                                </div>
                                <a class="btn btn-default btn-action" data-toggle="tooltip" data-placement="bottom"
                                   title="下载">
                                    <span class="glyphicon glyphicon-download-alt"></span></a>
                            </li>
                        </ul>
                        <!--<div class="navbar">
                        </div>-->
                    </div>
                    <div class="col-md-6">
                        <ul class="pull-right list-inline">
                            <li>
                                                <span>
                                                    第
                                                    <strong>1-20</strong>
                                                    项，共
                                                    <strong>55</strong>
                                                    项
                                                </span>
                            </li>
                            <li>
                                <div class="btn-group">
                                    <a class="btn btn-default"><span
                                            class="glyphicon glyphicon-chevron-left"></span></a>
                                    <a class="btn btn-default"><span
                                            class="glyphicon glyphicon-chevron-right"></span></a>
                                </div>
                                <a class="btn btn-default"><span class="glyphicon glyphicon-refresh"></span></a>
                                <a class="btn btn-default"><span class="glyphicon glyphicon-search"></span></a>
                                <!--<div class="btn-group">
                                    <a class="btn"><i class="icon-cog"></i></a>
                                </div>-->
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <hr class="toolbar-hr">
    </div>
</div>
<div class="col-md-12" style="padding-top: 55px;">
<div class="row">
<div class="col-md-3">
    <div class="system-sidebar">
        <ul class="nav system-sidenav">
            <!-- ko foreach: { data: taskList.filterLinks, as: 'filterLink' } -->
            <li class="nav-header"><span data-bind="text: name"></span></li>
            <li data-bind="if: value"><a data-bind="click: clear" href="javascript:void(0);"><span class="text-all"><span
                    class="glyphicon glyphicon-stop glyphicon-all"></span>全部</span></a></li>
            <li>
                <ul data-bind="foreach: { data: selectListItems, as: 'item' }" class="nav nav-list">
                    <li data-bind="attr: { 'class': filterLink.value() == item.value ? 'active' : ''}">
                        <a data-bind="text: item.name, click: filterLink.select" class="" href="#"></a>
                    </li>
                </ul>
            </li>
            <li>
                <hr>
            </li>
            <!-- /ko -->
        </ul>
    </div>
</div>
<div id="list" class="col-md-9">
    <div class="row">
        <div class="col-md-12">
            <table class="table table-hover list-table ">
                <colgroup>
                    <col style="width: 50px;">
                    <col style="width: 120px;">
                    <col style="width: 350px;">
                    <col style="width: 200px;">
                </colgroup>
                <!--<thead>
                <tr>
                    <th></th>
                    <th>截止时间</th>
                    <th>项目名称</th>
                    <th style="text-align: center;">负责人</th>
                </tr>
                </thead>-->
                <tbody data-bind="foreach: taskList.list">
                <tr data-bind="click: $root.showTaskEditView">
                    <td>
                        <input type="checkbox">
                    </td>
                    <td>
                        <span data-bind="html: daySpanHtml"></span>
                        <br>
                        <small data-bind="text: deadline" class="muted"></small>
                    </td>
                    <td><h5 data-bind="text: taskName" style="font-weight: bold"></h5></td>
                    <td>
                        <div style="text-align: center;"><span data-bind="text: personInCharge"></span></div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div id="edit" class="col-md-9" style="display: none">
<div class="row">
    <div class="col-md-5">
        <ul class="list-inline">
            <li>
                <div class="btn-group">
                    <a data-bind="click: showTaskListView" data-toggle="tooltip" data-placement="bottom"
                       class="btn btn-action" title="返回"><i
                            class="icon-arrow-left"></i></a>
                </div>
                <div class="btn-group item-action">
                    <a class="btn btn-action" data-toggle="tooltip" data-placement="bottom" title="保存"><i
                            class="icon-ok"></i></a>
                    <a class="btn btn-action" data-toggle="tooltip" data-placement="bottom" title="删除"><i
                            class="icon-trash"></i></a>
                </div>
                <div class="btn-group item-action">
                    <a class="btn dropdown-toggle btn-action" data-toggle="dropdown" title="标记"><i
                            class="icon-tags"></i> <span
                            class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#"><i class="icon-ok"></i> 标记为完成</a></li>
                        <li><a href="#"><i class="icon-off"></i> 标记为取消</a></li>
                    </ul>
                </div>
            </li>
        </ul>
        <!--<div class="navbar">
        </div>-->
    </div>
</div>
<hr class="toolbar-hr">
<div class="row">
<div class="col-md-10">
<ul id="myTab" class="nav nav-tabs">
    <li class="active"><a href="#info" data-toggle="tab">任务信息</a></li>
    <li class=""><a href="#comment" data-toggle="tab">评论</a></li>
</ul>
<div id="myTabContent" class="tab-content">
<div class="tab-pane fade active in" id="info">
    <form class="form-horizontal">
        <fieldset>
            <div class="control-group">
                <label class="control-label">项目类型：</label>

                <div class="controls">
                    <select>
                        <option>纵向研究</option>
                        <option>横向研究</option>
                        <option>横向咨询</option>
                        <option>纵向工作</option>
                        <option>中心工作</option>
                    </select>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="taskName">项目名称：</label>

                <div class="controls">
                    <input type="text" class="input-xxlarge" id="taskName">
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="description">委托单位：</label>

                <div class="controls">
                    <input id="description" type="text" class="input-xxlarge">
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">开始时间：</label>

                <div class="controls">
                    <div class="input-append date form_datetime">
                        <input size="16" type="text" value="">
                        <span class="add-on"><i class="icon-remove"></i></span>
                        <span class="add-on"><i class="icon-calendar"></i></span>
                    </div>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">截止时间：</label>

                <div class="controls">
                    <div class="input-append date form_datetime">
                        <input size="16" type="text" value="">
                        <span class="add-on"><i class="icon-remove"></i></span>
                        <span class="add-on"><i class="icon-calendar"></i></span>
                    </div>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">需完成的材料：</label>

                <div class="controls">
                    <textarea class="input-xxlarge" rows="3"></textarea>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">具体进展：</label>

                <div class="controls">
                    <textarea class="input-xxlarge" rows="3"></textarea>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">推进计划：</label>

                <div class="controls">
                    <textarea class="input-xxlarge" rows="3"></textarea>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="price">项目金额(元)：</label>

                <div class="controls">
                    <input id="price" type="text">
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="taskName">付款方式：</label>

                <div class="controls">
                    <input type="text">
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">到款情况：</label>

                <div class="controls">
                    <select>
                        <option>未到款</option>
                        <option>已收前期款</option>
                        <option>已全部到款</option>
                    </select>

                    <div class="input-prepend">
                        <span class="add-on">已收</span>
                        <input class="input-small" type="text">
                    </div>
                    <div class="input-prepend">
                        <span class="add-on">还有</span>
                        <input class="input-small" type="text">
                    </div>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">到款情况：</label>

                <div class="controls">
                    <select>
                        <option>未开票</option>
                        <option>已开票</option>
                        <option>已出具到账证明</option>
                    </select>
                </div>
            </div>
        </fieldset>
    </form>
    <div class="row">
        <div class="col-md-10">
            <div class="row">
                <div class="col-md-10">
                    <ul class="list-unstyled list-inline pull-right">
                        <li><a class="btn btn-small" href="#"><i class="icon-plus"></i> 上传附件</a></li>
                        <li><a class="btn btn-small" href="#"><i class="icon-download-alt"></i> 下载全部</a></li>
                    </ul>
                    <h4>附件列表</h4>

                    <table class="table attchment-table">
                        <colgroup>
                            <col style="width: 450px;">
                            <col style="width: 100px;">
                            <col style="width: 150px;">
                            <col style="width: 40px;">
                        </colgroup>
                        <tbody>
                        <tr>
                            <td><a href="#">咨询策划中心任务管理系统--需求分析.docx</a></td>
                            <td>上传用户</td>
                            <td>2013-8-22 10:20</td>
                            <td><a href="#"><i class="icon-remove"></i></a></td>
                        </tr>
                        <tr>
                            <td><a href="#">咨询策划中心任务管理系统--需求分析.docx</a></td>
                            <td>上传用户</td>
                            <td>2013-8-22 10:20</td>
                            <td><a href="#"><i class="icon-remove"></i></a></td>
                        </tr>
                        <tr>
                            <td><a href="#">咨询策划中心任务管理系统--需求分析.docx</a></td>
                            <td>上传用户</td>
                            <td>2013-8-22 10:20</td>
                            <td><a href="#"><i class="icon-remove"></i></a></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>
</div>
<div class="tab-pane fade" id="comment">
    <div class="row">
        <div class="col-md-10">
            <ul data-bind="foreach: tempDatas" class="list-unstyled comment">
                <li>
                    <span class="comment-user">用户</span>
                    <span class="comment-user">2013-8-20 9:00</span>
                    <ul class="list-unstyled list-inline pull-right">
                        <li><a class="comment-action-link" href="#">修改</a></li>
                        <li><a class="comment-action-link" href="#">删除</a></li>
                    </ul>
                    <hr class="title-content-hr">
                    <p class="comment-content">
                        感谢分享~</p>
                </li>
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-md-10">
            <div class="pagination">
                <ul>
                    <li class="disabled"><a href="#">&lt</a></li>
                    <li class="active"><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                    <li><a href="#">5</a></li>
                    <li><a href="#">...</a></li>
                    <li><a href="#">&gt</a></li>
                </ul>
                <div class="pull-right">
                    <span>共</span>
                    <strong>120</strong>
                    <span>条评论</span>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-8">
            <h5>发表评论：</h5>

            <form class="form-horizontal">
                <div class="control-group">
                    <textarea class="input-xxlarge" rows="5"></textarea>
                </div>
                <a class="btn btn-new btn-primary" href="#">提交评论</a>
            </form>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</div>
<div class="tab-pane fade" id="noteList">
    <div class="col-md-2">
        <ul class="nav nav-list">
            <li>
                <button data-bind="click: showNoteEditView" class="btn btn-danger btn-new">创建日志</button>
            </li>
            <li class="nav-header"><h5>记录日期</h5></li>
            <li>
                <ul class="nav nav-list">
                    <li><a href="#">2013年5月(2)</a></li>
                    <li><a href="#">2013年3月(12)</a></li>
                    <li><a href="#">2013年2月(2)</a></li>
                    <li><a href="#">2013年1月(1)</a></li>
                    <li><a href="#">2012年12月(12)</a></li>
                    <li><a href="#">2012年11月(4)</a></li>
                    <li><a href="#">2013年8月(5)</a></li>
                    <li><a href="#">2013年7月(8)</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="noteListView" class="col-md-10">
        <div class="row">
            <ul class="pull-right list-inline">
                <li>
                                   <span>
                                       第
                                       <strong>1-20</strong>
                                       条，共
                                       <strong>60</strong>
                                       条
                                   </span>
                </li>
                <li>
                    <div class="btn-group">
                        <a class="btn"><i class="icon-chevron-left"></i></a>
                        <a class="btn"><i class="icon-chevron-right"></i></a>
                    </div>
                    <div class="btn-group">
                        <a class="btn"><i class="icon-refresh"></i></a>
                    </div>
                    <!--<div class="btn-group">
                        <a class="btn"><i class="icon-cog"></i></a>
                    </div>-->
                </li>
            </ul>
        </div>
        <hr class="toolbar-hr">
        <div class="row">
            <div class="col-md-10">
                <!-- ko foreach: tempDatas -->
                <div class="row">
                    <div class="col-md-10">
                        <div class="note-item">
                            <div class="note-title"><a data-bind="click: $root.showNoteDetailView"
                                                       href="#">基于DTC的分布式事务管理模型之事务控制角色</a></div>
                            <div class="note-content">
                                我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型，首先来看看在这个模型中各个事务参与者各自扮演怎样的角色...
                            </div>
                            <hr class="note-hr">
                            <ul class="list-unstyled list-inline pull-right">
                                <li>
                                    <div class="note-date">2013-8-30 10:10 创建</div>
                                </li>
                                <li><a class="comment-action-link" href="#">删除</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
            </div>
        </div>
    </div>
    <div id="noteDetailView" class="col-md-10" style="display: none;">
        <div class="row">
            <div class="col-md-5">
                <ul class="list-inline">
                    <li>
                        <div class="btn-group">
                            <a data-bind="click: showNoteListView" data-toggle="tooltip" data-placement="bottom"
                               class="btn btn-action" title="返回"><i
                                    class="icon-arrow-left"></i></a>
                        </div>
                        <div class="btn-group item-action">
                            <a data-bind="click: showNoteEditView" class="btn btn-action" data-toggle="tooltip"
                               data-placement="bottom" title="编辑"><i
                                    class="icon-edit"></i></a>
                            <a class="btn btn-action" data-toggle="tooltip" data-placement="bottom" title="删除"><i
                                    class="icon-trash"></i></a>
                        </div>
                    </li>
                </ul>
                <!--<div class="navbar">
                </div>-->
            </div>
        </div>
        <hr class="toolbar-hr">
        <div class="row">
            <div class="col-md-10">
                <div class="note-detail-date pull-right">2013-8-30 10:10 创建</div>
                <h4>基于DTC的分布式事务管理模型之事务控制角色</h4>
                <hr class="note-detail-hr">
                <p style="letter-spacing: 1px;">
                    我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型。</br>
                    我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型。</br>
                    我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型。</br>
                    我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型。</br>
                    我们知道了SOA真正需要的是一个能够协调服务操作直接（通过服务自身访问的资源）或者间接（通过被调用服务访问的资源）访问的所有资源的分布式事务管理系统，这是一个复杂的架构体系。WCF，作为Windows平台下基于SOA的分布式框架，对分布式事务提供全面的支持。不过，WCF并不是另起炉灶，而是充分地利用了Windows现有的事务控制基础架构。本节着重讨论Windows事务处理模型。</br>
                </p>
            </div>
        </div>
    </div>
    <div id="noteEditView" class="col-md-10" style="display: none;">
        <div class="row">
            <div class="col-md-5">
                <ul class="list-inline">
                    <li>
                        <div class="btn-group">
                            <a data-bind="click: showNoteListView" data-toggle="tooltip" data-placement="bottom"
                               class="btn btn-action" title="返回"><i
                                    class="icon-arrow-left"></i></a>
                        </div>
                        <div class="btn-group item-action">
                            <a data-bind="click: showNoteEditView" class="btn btn-action" data-toggle="tooltip"
                               data-placement="bottom" title="保存"><i
                                    class="icon-ok"></i></a>
                            <a class="btn btn-action" data-toggle="tooltip" data-placement="bottom" title="删除"><i
                                    class="icon-trash"></i></a>
                        </div>
                    </li>
                </ul>
                <!--<div class="navbar">
                </div>-->
            </div>
        </div>
        <hr class="toolbar-hr">
        <form class="form-horizontal" style="margin-top: 20px">
            <fieldset>
                <div class="control-group">
                    <label class="control-label" style="width: 60px; text-align: left">标题：</label>

                    <div class="controls" style="margin-left: 70px;">
                        <input type="text" class="input-xxlarge">
                    </div>
                </div>
                <div style="height: 600px;">
                    <textarea class="ckeditor" id="editor1" name="editor1" style="600px">
                    </textarea>
                </div>
            </fieldset>
        </form>
    </div>
</div>
</div>
</div>
</div>
</div>
<script>

    $(document).ready(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_minimal'
        });
        $(".form_datetime").datetimepicker({
            format: "yyyy-mm-dd",
            autoclose: true,
            pickerPosition: "bottom-left",
            minView: "month",
            language: "zh-CN",
            todayBtn: true
        });
        $('.btn-action').tooltip();
    });

    //生成展示数据
    function loadTasks() {
        var daySpans = [-1, 0, 0, 3, 3, 5, 7, 10, 15, 26, 30, 31, 32, 38, 40, 80, 100, 130, 400, 430],
                status = [1, 0, 1, 1, 3, 1, 1, 1, 2, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ],
                data = [],
                now;
        for (var i = 0; i < daySpans.length; i++) {
            now = new Date();
            now.setDate(now.getDate() + daySpans[i]);
            data.push(new taskViewModel({
                Deadline: now,
                TaskName: "自动部署工具自动部署工具自动部署工具自动部署工具部署工具",
                PersonInCharge: "负责人",
                Creator: "创建人",
                CreateTime: new Date(2013, 5, 1),
                Status: status[i]
            }));
        }
        return data;
    }

    function formatDateString(date) {
        return date.getFullYear() + "年" + (date.getMonth() + 1) + "月" + date.getDate() + "日";
    }

    var filterLinkViewModel = function (field, name, selectListItems, defaultValue) {
        var self = this;
        self.field = field;
        self.name = name;
        self.selectListItems = selectListItems;
        self.value = ko.observable(defaultValue);
        self.select = function (data) {
            self.value(data.value);
        };
        self.clear = function () {
            self.value("");
        }
    };

    var taskListViewModel = function () {
        var self = this;
        self.filterLinks = ko.observableArray([
            new filterLinkViewModel("Status", "任务状态", [
                {value: "1", name: "未完成"},
                {value: "2", name: "已完成"},
                {value: "3", name: "已取消"},
                {value: "4", name: "发布待审"},
                {value: "5", name: "完成待审"}
            ], "1"),
            new filterLinkViewModel("Deadline", "到期时间", [
                {value: "1", name: "三天内"},
                {value: "2", name: "一周内"},
                {value: "3", name: "一个月内"}
            ], "1"),
            new filterLinkViewModel("TaskType", "任务类型", [
                {value: "1", name: "我负责的"},
                {value: "2", name: "我参与的"}
            ], "")
        ]);
        self.list = ko.observableArray(loadTasks());
        self.paginationInfo = ko.observable(new paginationInfo(1, 20, 0));
    };

    var paginationInfo = function (pageIndex, pageSize, total) {
        var self = this;
        self.pageIndex = pageIndex;
        self.pageSize = pageSize;
        self.total = total;
    };

    var taskViewModel = function (task) {
        var self = this,
                init = function (task) {
                    self.deadline = formatDateString(task.Deadline);
                    self.taskName = task.TaskName;
                    self.personInCharge = task.PersonInCharge;
                    self.creator = task.Creator;
                    self.createTime = formatDateString(task.CreateTime);
                    self.status = task.Status;
                    self.daySpanHtml = taskDaySpanHtml(task);
                },

                taskDaySpanHtml = function (task) {
                    if (task.Status == 1) {
                        var daySpan = parseInt((task.Deadline - new Date()) / 1000 / 60 / 60 / 24),
                                daySpanStr = daySpan,
                                daySpanClass,
                                prefix = "";
                        if (daySpan < 0) {
                            daySpanStr = -daySpan;
                            daySpanClass = "timespan-expired";
                            prefix = "<small>过期</small>";
                        }
                        else if (daySpan == 0) {
                            daySpanStr = "今"
                            daySpanClass = "timespan-day";
                        } else if (daySpan <= 3) {
                            daySpanClass = "timespan-day";
                        } else if (daySpan <= 7) {
                            daySpanClass = "timespan-week";
                        } else if (daySpan <= 30) {
                            daySpanClass = "timespan-month";
                        } else {
                            daySpanClass = "timespan";
                        }
                        return prefix + '<span class="' + daySpanClass + '">' + daySpanStr + '</span><small>天</small>';
                    }
                    else {
                        var statusName = "";
                        switch (task.Status) {
                            case 0:
                                statusName = "发布待审";
                                break;
                            case 2:
                                statusName = "完成待审";
                                break;
                            case 3:
                                statusName = "已完成";
                                break;
                        }
                        return '<small class="text-info">' + statusName + '</small> ';
                    }
                };
        init(task);
        return self;
    };

    var indexViewModel = function () {
        var self = this;
        self.taskList = new taskListViewModel();
        self.tempDatas = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        self.showTaskEditView = function () {
            $("#list").hide();
            $("#edit").show();
        };
        self.showTaskListView = function () {
            $("#list").show();
            $("#edit").hide();
        };
        self.showNoteDetailView = function () {
            $("#noteListView").hide();
            $("#noteEditView").hide();
            $("#noteDetailView").show();
        };

        self.showNoteEditView = function () {
            $("#noteDetailView").hide();
            $("#noteListView").hide();
            $("#noteEditView").show();
        };
        self.showNoteListView = function () {
            $("#noteEditView").hide();
            $("#noteDetailView").hide();
            $("#noteListView").show();
        };
    };

    ko.applyBindings(new indexViewModel());

</script>
</body>
</html>